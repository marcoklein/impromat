FROM node:16-alpine

# Dokku requires bash
RUN apk add --no-cache bash

WORKDIR /app
COPY . .
RUN yarn install --frozen-lockfile

ARG REACT_APP_API_URL
ENV REACT_APP_API_URL ${REACT_APP_API_URL}
ARG REACT_APP_VERSION
ENV REACT_APP_VERSION ${REACT_APP_VERSION}
WORKDIR /app/packages/impromat
RUN yarn build

CMD ["yarn", "build:serve"]
